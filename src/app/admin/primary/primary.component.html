<div class="container-fluid table-container" [class.px-0]="model.isMobileView">
    <div class="w-100" [ngClass]="model.isMobileView ? 'h-100' : 'mt-2'">
        <div class="w-100 d-flex h-100">
            <div *ngIf="model.dataSource && model.dataSource.data.length < 1" class="w-100">
                <app-empty-data></app-empty-data>
            </div>
            <div [hidden]="model.dataSource && model.dataSource.data.length < 1" class="mat-elevation-z8">
                <table mat-table [dataSource]="model.dataSource" matSort matSortActive="bookingDate" matSortDirection="desc"
                    matSortDisableClear="true">
                    <ng-container matColumnDef="mobileView">
                        <th mat-header-cell *matHeaderCellDef></th>
                        <td mat-cell *matCellDef="let element" class="py-2">
                            <div class="d-flex justify-content-between align-items-start">
                                <div class="d-flex flex-column">
                                    <div class="mb-2">
                                        <app-ticket-status [status]="element.bookingStatus"></app-ticket-status>
                                    </div>
                                    <div><b>{{'common.name' | translate}}:</b> {{element.name}}</div>
                                    <div class="d-flex">
                                        <b>{{'common.mobile' | translate}}:</b>
                                        {{element.mobile}}
                                    </div>
                                    <div><b>{{'common.adultsCount' | translate}}:</b> {{element.adultsCount + 1}}</div>
                                    <div><b>{{'common.childrenCount' | translate}}:</b> {{element.childrenCount}}</div>
                                    <div> <b>{{'common.totalCost' | translate}}:</b>
                                        <a (click)="viewCostDetails(element)" class="total">
                                            {{element.totalCost}}
                                        </a>
                                    </div>
                                    <div> <b>{{'common.paid' | translate}}:</b> {{element.paid}}</div>
                                    <div> <b>{{'common.remaining' | translate}}:</b> {{ element.totalCost - element.paid }}</div>
                                    <div class="d-flex">
                                        <b>{{'common.room' | translate}}:</b>&nbsp;
                                        <ng-container *ngIf="element.room; else empty">
                                            {{ element.room }}
                                        </ng-container>
                                    </div>
                                    <div class="d-flex">
                                        <b>{{'common.gender' | translate}}:</b>&nbsp;
                                        <ng-container [ngSwitch]="element.gender">
                                            <ng-container *ngSwitchCase="model.gender.male">
                                                {{ 'common.male' | translate }}
                                            </ng-container>
                                            <ng-container *ngSwitchDefault>
                                                {{ 'common.female' | translate }}
                                            </ng-container>
                                        </ng-container>
                                    </div>
                                    <div class="d-flex">
                                        <b>{{'common.bookingType' | translate}}:</b> &nbsp;
                                        <ng-container [ngSwitch]="element.bookingType">
                                            <div *ngSwitchCase="1">
                                                {{ 'common.individual' | translate }}
                                            </div>
                                            <div *ngSwitchDefault>
                                                {{ 'common.group' | translate }}
                                            </div>
                                            &nbsp;
                                            <div class="d-flex">
                                                (
                                                    <ng-container *ngIf="element.roomType; else empty">
                                                        <ng-container [ngSwitch]="element.roomType">
                                                        <div *ngSwitchCase="model.roomType.double">
                                                            {{ 'common.double' | translate }}
                                                        </div>
                                                        <div *ngSwitchCase="model.roomType.triple">
                                                            {{ 'common.triple' | translate }}
                                                        </div>
                                                        <div *ngSwitchCase="model.roomType.quad">
                                                            {{ 'common.quad' | translate }}
                                                        </div>
                                                        <div *ngSwitchDefault>
                                                            {{ 'room.single' | translate }}
                                                        </div>
                                                        </ng-container>
                                                    </ng-container>
                                                )
                                            </div>
                                        </ng-container>
                                    </div>
                                    <div><b>{{'common.transportationName' | translate}}</b>: {{ element.transportationName }} </div>
                                    <div><b>{{'menu.address' | translate}}</b>: {{ element.addressName }} </div>
                                    <div><b>{{'common.age' | translate}}</b>: {{ element.age }} </div>
                                    <div><b>{{'common.birthDate' | translate}}:</b> {{element.birthDate.toMillis() | date}}</div>
                                    <div> <b>{{'common.bookingDate' | translate}}:</b> {{element.bookingDate.toMillis() | date:'medium'}}</div>
                                    <div class="d-flex">
                                        <b>{{'common.lastUpdateDate' | translate}}:</b>&nbsp;
                                        <ng-container *ngIf="element.lastUpdateDate; else empty">
                                            {{element.lastUpdateDate.toMillis() | date:'medium'}}
                                        </ng-container>
                                    </div>
                                    <div class="d-flex">
                                        <b>{{'common.lastUpdatedBy' | translate}}:</b>&nbsp;
                                        <ng-container *ngIf="element.lastUpdatedBy; else empty">{{element.lastUpdatedBy}}</ng-container>
                                    </div>
                                    <div> <b>{{'common.userNotes' | translate}}:</b>
                                        <ng-container *ngIf="element.userNotes; else empty">
                                            {{element.userNotes}}
                                        </ng-container>
                                    </div>
                                    <div> <b>{{'common.adminNotes' | translate}}:</b>
                                        <ng-container *ngIf="element.adminNotes; else empty">
                                            {{element.adminNotes}}
                                        </ng-container>
                                    </div>
                                </div>
                                <div class="d-flex flex-column">
                                    <div>
                                        <button mat-icon-button color="primary" [matMenuTriggerFor]="menu">
                                            <i class="fa-solid fa-ellipsis"></i>
                                        </button>
                                        <mat-menu #menu="matMenu">
                                            <button mat-menu-item class="primary" (click)="update(element)">
                                                {{'common.edit' | translate}}
                                            </button>
                                            <button *ngIf="element.bookingStatus != model.bookingStatus.deleted" mat-menu-item class="text-danger"
                                                (click)="delete(element)">
                                                {{'common.delete' | translate}}
                                            </button>
                                        </mat-menu>
                                    </div>
                                    <app-social-media [mobile]="element.mobile"></app-social-media>
                                </div>
                            </div>
                        </td>
                        <td mat-footer-cell *matFooterCellDef class="px-0">
                            <div class="pr-3 d-flex">
                                {{'common.total' | translate}}: <b>{{model.total}}</b>
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="name" sticky>
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.name' | translate}}</th>
                        <td mat-cell *matCellDef="let element" class="width-175">
                            <div>{{element.name}}</div>
                            <div class="py-2">{{element.mobile}}</div>
                            <app-social-media [mobile]="element.mobile"></app-social-media>
                        </td>
                        <td mat-footer-cell *matFooterCellDef>
                            <div class="d-flex">
                                {{'common.total' | translate}}: <b>{{model.total}}</b>
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="counts">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'table.counts' | translate}}</th>
                        <td mat-cell *matCellDef="let element">
                            <div class="d-flex">
                                <div class="font-weight-bold">{{'table.adultsCount' | translate}}: &nbsp;</div>
                                <div>{{ element.adultsCount + 1 }}</div>
                            </div>
                            <div class="d-flex">
                                <div class="font-weight-bold">{{'table.childrenCount' | translate}}: &nbsp;</div>
                                <div>{{ element.childrenCount + 1 }}</div>
                            </div>
                        </td>
                        <td mat-footer-cell *matFooterCellDef>
                            <div class="d-flex flex-column justify-content-center align-items-center">
                                <div class="d-flex">
                                    <div class="font-weight-bold">{{'table.adultsCount' | translate}}: &nbsp;</div>
                                    <div>{{getAllAdultsCount()}}</div>
                                </div>
                                <div class="d-flex">
                                    <div class="font-weight-bold">{{'table.childrenCount' | translate}}: &nbsp;</div>
                                    <div>{{ getAllChildrenCount() }}</div>
                                </div>
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="roomId">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.room' | translate}}</th>
                        <td mat-cell *matCellDef="let element">
                            <ng-container *ngIf="element.room; else empty">
                                {{ element.room }}
                            </ng-container>
                        </td>
                        <td mat-footer-cell *matFooterCellDef></td>
                    </ng-container>

                    <ng-container matColumnDef="transportation">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.transportationName' | translate}}</th>
                        <td mat-cell *matCellDef="let element">{{ element.transportationName }}</td>
                        <td mat-footer-cell *matFooterCellDef></td>
                    </ng-container>

                    <ng-container matColumnDef="addressName">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'menu.address' | translate}}</th>
                        <td mat-cell *matCellDef="let element">{{ element.addressName }}</td>
                        <td mat-footer-cell *matFooterCellDef></td>
                    </ng-container>

                    <ng-container matColumnDef="bookingType">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.bookingType' | translate}}</th>
                        <td mat-cell *matCellDef="let element" class="width-135">
                            <ng-container [ngSwitch]="element.bookingType">
                                <div *ngSwitchCase="1">
                                    {{ 'common.individual' | translate }}
                                </div>
                                <div *ngSwitchDefault>
                                    {{ 'common.group' | translate }}
                                </div>
                            </ng-container>
                            <div class="d-flex">
                                (
                                    <ng-container *ngIf="element.roomType; else empty">
                                        <ng-container [ngSwitch]="element.roomType">
                                        <div *ngSwitchCase="model.roomType.double">
                                            {{ 'common.double' | translate }}
                                        </div>
                                        <div *ngSwitchCase="model.roomType.triple">
                                            {{ 'common.triple' | translate }}
                                        </div>
                                        <div *ngSwitchCase="model.roomType.quad">
                                            {{ 'common.quad' | translate }}
                                        </div>
                                        <div *ngSwitchDefault>
                                            {{ 'room.single' | translate }}
                                        </div>
                                        </ng-container>
                                    </ng-container>
                                )
                            </div>
                        </td>
                        <td mat-footer-cell *matFooterCellDef></td>
                    </ng-container>

                    <ng-container matColumnDef="birthDate">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.birthDate' | translate}}</th>
                        <td mat-cell *matCellDef="let element" class="width-135">{{ element.birthDate.toMillis() | date }}</td>
                        <td mat-footer-cell *matFooterCellDef></td>
                    </ng-container>

                    <ng-container matColumnDef="age">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.age' | translate}}</th>
                        <td mat-cell *matCellDef="let element">{{ element.age }}</td>
                        <td mat-footer-cell *matFooterCellDef></td>
                    </ng-container>

                    <ng-container matColumnDef="bookingDate">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.bookingDate' | translate}}</th>
                        <td mat-cell *matCellDef="let element" class="width-135">{{ element.bookingDate.toMillis() | date:'medium' }}</td>
                        <td mat-footer-cell *matFooterCellDef></td>
                    </ng-container>

                    <ng-container matColumnDef="gender">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.gender' | translate}}</th>
                        <td mat-cell *matCellDef="let element">
                            <ng-container [ngSwitch]="element.gender">
                                <ng-container *ngSwitchCase="model.gender.male">
                                    {{ 'common.male' | translate }}
                                </ng-container>
                                <ng-container *ngSwitchDefault>
                                    {{ 'common.female' | translate }}
                                </ng-container>
                            </ng-container>
                        </td>
                        <td mat-footer-cell *matFooterCellDef></td>
                    </ng-container>

                    <ng-container matColumnDef="price">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.price' | translate}}</th>
                        <td mat-cell *matCellDef="let element">
                            <div class="d-flex">
                                <div class="font-weight-bold">{{'common.totalCost' | translate}}:&nbsp;</div>
                                <a (click)="viewCostDetails(element)" class="total">
                                    {{element.totalCost}}
                                </a>
                            </div>
                            <div class="d-flex">
                                <div class="font-weight-bold">{{'common.paid' | translate}}:&nbsp;</div>
                                <div>{{element.paid}}</div>
                            </div>
                            <div class="d-flex">
                                <div class="font-weight-bold">{{'common.remaining' | translate}}:&nbsp;</div>
                                <div>{{ element.totalCost - element.paid }}</div>
                            </div>
                        </td>
                        <td mat-footer-cell *matFooterCellDef> {{getAllTotalCost()}} </td>
                    </ng-container>

                    <ng-container matColumnDef="bookingStatus">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'table.bookingStatus' | translate}}</th>
                        <td mat-cell *matCellDef="let element">
                            <app-ticket-status [status]="element.bookingStatus"></app-ticket-status>
                        </td>
                        <td mat-footer-cell *matFooterCellDef></td>
                    </ng-container>

                    <ng-container matColumnDef="notes">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.notes' | translate}}</th>
                        <td mat-cell *matCellDef="let element" class="text-truncate">
                            <div class="d-flex" [matTooltip]="element.userNotes" matTooltipPosition="above">
                                <div>{{'common.userNotes' | translate}}:&nbsp;</div>
                                <ng-container *ngIf="element.userNotes; else empty">
                                    {{element.userNotes}}
                                </ng-container>
                            </div>
                            <div class="d-flex" [matTooltip]="element.adminNotes" matTooltipPosition="above">
                                <div>{{'common.adminNotes' | translate}}:&nbsp;</div>
                                <ng-container *ngIf="element.adminNotes; else empty">
                                    {{element.adminNotes}}
                                </ng-container>
                            </div>
                        </td>
                        <td mat-footer-cell *matFooterCellDef></td>
                    </ng-container>

                    <ng-container matColumnDef="lastUpdate">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.lastUpdate' | translate}}</th>
                        <td mat-cell *matCellDef="let element">
                            <div class="d-flex">
                                <div class="font-weight-bold">{{'common.lastUpdatedBy' | translate}}:&nbsp;</div>
                                <ng-container *ngIf="element.lastUpdatedBy; else empty">{{element.lastUpdatedBy}}</ng-container>
                            </div>
                            <div class="d-flex">
                                <div class="font-weight-bold">{{'common.lastUpdateDate' | translate}}:&nbsp;</div>
                                <ng-container *ngIf="element.lastUpdateDate; else empty">
                                    <div>{{element.lastUpdateDate.toMillis() | date:'medium'}}</div>
                                </ng-container>
                            </div>
                        </td>
                        <td mat-footer-cell *matFooterCellDef></td>
                    </ng-container>

                    <ng-container matColumnDef="actions" stickyEnd>
                        <th mat-header-cell *matHeaderCellDef></th>
                        <td mat-cell *matCellDef="let element">
                            <button mat-icon-button color="primary" [matMenuTriggerFor]="menu">
                                <i class="fa-solid fa-ellipsis"></i>
                            </button>
                            <mat-menu #menu="matMenu">
                                <button mat-menu-item class="primary" (click)="update(element)">
                                    {{'common.edit' | translate}}
                                </button>
                                <button *ngIf="element.bookingStatus != model.bookingStatus.deleted" mat-menu-item class="text-danger" (click)="delete(element)">
                                    {{'common.delete' | translate}}
                                </button>
                            </mat-menu>
                        </td>
                        <td mat-footer-cell *matFooterCellDef></td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="model.displayedColumns; sticky: true"></tr>
                    <tr mat-row *matRowDef="let row; columns: model.displayedColumns;"></tr>
                    <tr mat-footer-row *matFooterRowDef="model.displayedColumns; sticky: true"></tr>
                </table>
            </div>
        </div>
    </div>
</div>


<button mat-icon-button color="primary" class="mobile-filter-button d-flex" [matMenuTriggerFor]="menu">
    <i class="fa-solid fa-ellipsis-vertical"></i>
    <mat-menu #menu="matMenu">
      <button mat-menu-item class="primary" (click)="showAdvancedFilter()">
        <i class="fa-solid fa-filter"></i>&nbsp;
        البحث المتقدم
      </button>
      <button mat-menu-item class="primary" (click)="openExportModal()">
        <i class="fa-solid fa-download"></i>&nbsp;
        تصدير الأعضاء
      </button>
      <button mat-menu-item class="primary" (click)="add()">
        <i class="fa-regular fa-square-plus"></i>&nbsp;
        إضافة أشتراك
      </button>
    </mat-menu>
</button>

<ng-template #empty>
    ---
</ng-template>

<div class="container-fluid table-container" [class.px-0]="model.isMobileView">
  <div class="w-100 h-100" [ngClass]="model.isMobileView ? 'h-100' : 'mt-2'">
    <div class="w-100 d-flex h-100">
      <div *ngIf="model.dataSource && model.dataSource.data.length < 1" class="w-100">
        <app-empty-data></app-empty-data>
      </div>
      <div [hidden]="model.dataSource && model.dataSource.data.length < 1" class="mat-elevation-z8">
        <table mat-table [dataSource]="model.dataSource" matSort matSortActive="name" matSortDirection="asc"
          matSortDisableClear="true">
          <ng-container matColumnDef="mobileView">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let element" class="py-2">
              <div class="d-flex justify-content-between align-items-start">
                <div>
                  <div class="d-flex">
                    <div class="mb-2">
                      <app-ticket-status [status]="element.bookingStatus"></app-ticket-status>
                    </div>
                    <span class="mx-2">
                      <i *ngIf="element.isChild" class="fa-solid fa-child primary"></i>
                      <i *ngIf="element.isMain" class="fa-solid fa-star primary"></i>
                    </span>
                  </div>
                  <div><b>{{'common.name' | translate}}:</b> {{element.name}}</div>
                  <small class="text-success">
                    {{element.mainMemberName}} <i *ngIf="!element.isMain" class="fa-solid fa-star"></i>
                  </small>
                  <div *ngIf="element.isMain"> <b>{{'common.totalCost' | translate}}:</b>
                    {{element.totalCost}} جنيه
                  </div>
                  <div *ngIf="element.isMain"> <b>{{'common.paid' | translate}}: &nbsp;</b> {{element.paid}} جنيه</div>
                  <div *ngIf="element.isMain">
                    <b>{{'common.remaining' | translate}}:</b>
                    {{ element.totalCost - element.paid }}
                    جنيه
                  </div>
                  <div class="d-flex">
                    <b>{{'common.mobile' | translate}}:&nbsp;</b>
                    {{ element.mobile }}
                  </div>
                  <div><b>{{'common.birthDate' | translate}}:</b> {{ element.birthDate.toMillis() | date }}</div>
                  <div><b>{{'common.age' | translate}}:</b> {{element.age}}</div>
                  <div class="d-flex flex-row">
                    <b>{{'common.gender' | translate}}:</b>&nbsp;
                    <ng-container [ngSwitch]="element.gender">
                      <div *ngSwitchCase="1">
                        {{ 'common.male' | translate }}
                      </div>
                      <div *ngSwitchDefault>
                        {{ 'common.female' | translate }}
                      </div>
                    </ng-container>
                  </div>
                  <div *ngIf="element.address"><b>{{'menu.address' | translate}}:</b> {{element.address}}</div>
                  <div *ngIf="element.transportationName"><b>{{'common.transportationName' | translate}}:</b> {{element.transportationName}}</div>
                  <div class="d-flex">
                    <b>{{'common.room' | translate}}:</b>&nbsp;
                    <ng-container *ngIf="element.displayedRoomName; else empty">
                      {{ element.displayedRoomName }}
                    </ng-container>
                  </div>
                </div>
                <div class="d-flex justify-content-between flex-column">
                  <app-social-media [mobile]="element.mobile"></app-social-media>
                  <a *ngIf="element.bookingStatus != model.bookingStatus.deleted" href="javascript:void(0)" (click)="addRoomToMember(element)" class="primary pt-4">
                    <i class="fa-solid fa-bed"></i>
                  </a>
                </div>
              </div>

            </td>
            <td mat-footer-cell *matFooterCellDef class="px-0">
              <div class="pr-3 d-flex">
                {{'common.total' | translate}}: <b>{{model.total}}</b>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.name' | translate}}</th>
            <td mat-cell *matCellDef="let element" class="col-3">
              <div class="d-flex">
                <div class="d-flex flex-column">
                  <div>{{element.name}}</div>
                  <small class="text-success">
                    {{element.mainMemberName}} <i *ngIf="!element.isMain" class="fa-solid fa-star"></i>
                  </small>
                </div>
                <div class="px-2">
                  <i *ngIf="element.isChild" class="fa-solid fa-child primary"></i>
                  <i *ngIf="element.isMain" class="fa-solid fa-star primary"></i>
                </div>
              </div>
            </td>
            <td mat-footer-cell *matFooterCellDef>
              <div class="d-flex">
                {{'common.total' | translate}}: <b>{{model.total}}</b>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="mobile">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.mobile' | translate}}</th>
            <td mat-cell *matCellDef="let element" class="width-135">
              <div class="text-center">
                <div>{{ element.mobile}}</div>
                <app-social-media [mobile]="element.mobile"></app-social-media>
              </div>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>

          <ng-container matColumnDef="birthDate">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.birthDate' | translate}}</th>
            <td mat-cell *matCellDef="let element" class="width-135">
              {{ element.birthDate.toMillis() | date }}
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>

          <ng-container matColumnDef="gender">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.gender' | translate}}</th>
            <td mat-cell *matCellDef="let element">
              <ng-container [ngSwitch]="element.gender">
                <div *ngSwitchCase="1">
                  {{ 'common.male' | translate }}
                </div>
                <div *ngSwitchDefault>
                  {{ 'common.female' | translate }}
                </div>
              </ng-container>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>

          <ng-container matColumnDef="age">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.age' | translate}}</th>
            <td mat-cell *matCellDef="let element" class="col-1">{{element.age}}</td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>

          <ng-container matColumnDef="address">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'menu.address' | translate}}</th>
            <td mat-cell *matCellDef="let element" class="col-1">
              <ng-container *ngIf="element.isMain; else empty">
                {{element.address}}
              </ng-container>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>

          <ng-container matColumnDef="transportation">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.transportationName' | translate}}</th>
            <td mat-cell *matCellDef="let element">
              <ng-container *ngIf="element.isMain; else empty">
                {{element.transportationName}}
              </ng-container>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>

          <ng-container matColumnDef="total">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.totalCost' | translate}}</th>
            <td mat-cell *matCellDef="let element">
              <ng-container *ngIf="element.isMain; else empty">
                {{element.totalCost}}
              </ng-container>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
        </ng-container>

        <ng-container matColumnDef="paid">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.paid' | translate}}</th>
            <td mat-cell *matCellDef="let element">
              <ng-container *ngIf="element.isMain; else empty">
                {{element.paid}}
              </ng-container>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
        </ng-container>

        <ng-container matColumnDef="remaining">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.remaining' | translate}}</th>
            <td mat-cell *matCellDef="let element">
              <ng-container *ngIf="element.isMain; else empty">
                {{ element.totalCost - element.paid }}
              </ng-container>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
        </ng-container>

          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{'common.bookingStatus' | translate}}
            </th>
            <td mat-cell *matCellDef="let element" class="col-1">
              <ng-container *ngIf="element.isMain; else empty">
                <app-ticket-status [status]="element.bookingStatus"></app-ticket-status>
              </ng-container>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>

          <ng-container matColumnDef="roomType">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.reservationType' | translate}}</th>
            <td mat-cell *matCellDef="let element" class="col-1">
              <ng-container *ngIf="element.roomType; else empty">
                <ng-container [ngSwitch]="element.roomType">
                  <div *ngSwitchCase="model.roomType.double">
                    {{ 'common.double' | translate }}
                  </div>
                  <div *ngSwitchCase="model.roomType.triple">
                    {{ 'common.triple' | translate }}
                  </div>
                  <div *ngSwitchCase="model.roomType.quad">
                    {{ 'common.quad' | translate }}
                  </div>
                  <div *ngSwitchDefault>
                    {{ 'room.single' | translate }}
                  </div>
                </ng-container>
              </ng-container>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>

          <ng-container matColumnDef="userNotes">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.userNotes' | translate}}</th>
            <td mat-cell *matCellDef="let element" class="width-100 text-truncate" [matTooltip]="element.userNotes" matTooltipPosition="above">
                <ng-container *ngIf="element.userNotes; else empty">
                    {{element.userNotes}}
                </ng-container>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>

          <ng-container matColumnDef="adminNotes">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.adminNotes' | translate}}</th>
            <td mat-cell *matCellDef="let element" class="width-100 text-truncate" [matTooltip]="element.adminNotes" matTooltipPosition="above">
                <ng-container *ngIf="element.adminNotes; else empty">
                  {{element.adminNotes}}
                </ng-container>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>

          <ng-container matColumnDef="room">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{'common.room' | translate}}</th>
            <td mat-cell *matCellDef="let element" class="col-3">
              <ng-container *ngIf="element.displayedRoomName; else empty">
                {{ element.displayedRoomName }}
              </ng-container>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>
          
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef class="col-1"></th>
            <td mat-cell *matCellDef="let element">
              <button *ngIf="element.bookingStatus != model.bookingStatus.deleted" mat-stroked-button color="primary" (click)="addRoomToMember(element)">
                تسكين
              </button>
            </td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="model.displayedColumns; sticky: true"></tr>
          <tr mat-row *matRowDef="let row; columns: model.displayedColumns;"></tr>
          <tr mat-footer-row *matFooterRowDef="model.displayedColumns; sticky: true"></tr>
        </table>
      </div>
    </div>
  </div>
</div>

<button mat-icon-button color="primary" class="mobile-filter-button d-flex justify-content-center" [matMenuTriggerFor]="menu">
  <i class="fa-solid fa-ellipsis-vertical"></i>
  <mat-menu #menu="matMenu">
    <button mat-menu-item class="primary" (click)="showAdvancedFilter()">
      <i class="fa-solid fa-filter"></i>&nbsp;
      البحث المتقدم
    </button>
    <button mat-menu-item class="primary" (click)="openExportModal()">
      <i class="fa-solid fa-download"></i>&nbsp;
      تصدير الأعضاء
    </button>
  </mat-menu>
</button>

<ng-template #empty>-</ng-template>
